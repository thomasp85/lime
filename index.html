<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Local Interpretable Model-Agnostic Explanations • lime</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Local Interpretable Model-Agnostic Explanations">
<meta property="og:description" content="When building complex models, it is often difficult to explain why
    the model should be trusted. While global measures such as accuracy are
    useful, they cannot be used for explaining why a model made a specific
    prediction. lime (a port of the lime Python package) is a method for
    explaining the outcome of black box models by fitting a local model around
    the point in question an perturbations of this point. The approach is
    described in more detail in the article by Ribeiro et al. (2016) 
    &lt;arXiv:1602.04938&gt;.">
<meta property="og:image" content="https://lime.data-imaginist.com/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">lime</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.data-imaginist.com/2018/lime-v0-4-the-kitten-picture-edition/">Version 0.4.0</a>
    </li>
    <li>
      <a href="https://www.data-imaginist.com/2017/announcing-lime/">Version 0.3.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/thomasp85/lime">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="lime-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#lime-" class="anchor"></a>lime <img src="reference/figures/logo.png" width="131px" height="140px" align="right" style="padding-left:10px;background-color:white;">
</h1></div>
<!-- badges: start -->

<blockquote>
<p>There once was a package called lime,</p>
<p>Whose models were simply sublime,</p>
<p>It gave explanations for their variations,</p>
<p>one observation at a time.</p>
</blockquote>
<p><em>lime-rick by Mara Averick</em></p>
<hr>
<p><em>This is an R port of the Python lime package (<a href="https://github.com/marcotcr/lime" class="uri">https://github.com/marcotcr/lime</a>) developed by the authors of the lime (Local Interpretable Model-agnostic Explanations) approach for black-box model explanations. All credits for the invention of the approach goes to the original developers.</em></p>
<p>The purpose of <code>lime</code> is to explain the predictions of black box classifiers. What this means is that for any given prediction and any given classifier it is able to determine a small set of features in the original data that has driven the outcome of the prediction. To learn more about the methodology of <code>lime</code> read the <a href="https://arxiv.org/abs/1602.04938">paper</a> and visit the repository of the <a href="https://github.com/marcotcr/lime">original implementation</a>.</p>
<p>The <code>lime</code> package for R does not aim to be a line-by-line port of its Python counterpart. Instead it takes the ideas laid out in the original code and implements them in an API that is idiomatic to R.</p>
<div id="an-example" class="section level2">
<h2 class="hasAnchor">
<a href="#an-example" class="anchor"></a>An example</h2>
<p>Out of the box <code>lime</code> supports a long range of models, e.g. those created with caret, parsnip, and mlr. Support for unsupported models are easy to achieve by adding a <code>predict_model</code> and <code>model_type</code> method for the given model.</p>
<p>The following shows how a random forest model is trained on the iris data set and how <code>lime</code> is then used to explain a set of new observations:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">caret</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lime.data-imaginist.com">lime</a></span><span class="op">)</span>

<span class="co"># Split up the data set</span>
<span class="va">iris_test</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="va">iris_train</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="va">iris_lab</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Create Random Forest model on iris data</span>
<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span><span class="va">iris_train</span>, <span class="va">iris_lab</span>, method <span class="op">=</span> <span class="st">'rf'</span><span class="op">)</span>

<span class="co"># Create an explainer object</span>
<span class="va">explainer</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/lime.html">lime</a></span><span class="op">(</span><span class="va">iris_train</span>, <span class="va">model</span><span class="op">)</span>

<span class="co"># Explain new observation</span>
<span class="va">explanation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/explain.html">explain</a></span><span class="op">(</span><span class="va">iris_test</span>, <span class="va">explainer</span>, n_labels <span class="op">=</span> <span class="fl">1</span>, n_features <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="co"># The output is provided in a consistent tabular format and includes the</span>
<span class="co"># output from the model.</span>
<span class="va">explanation</span>
<span class="co">#&gt; # A tibble: 10 x 13</span>
<span class="co">#&gt;    model_type case  label label_prob model_r2 model_intercept model_prediction</span>
<span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1 classific… 1     seto…          1    0.681           0.129            0.987</span>
<span class="co">#&gt;  2 classific… 1     seto…          1    0.681           0.129            0.987</span>
<span class="co">#&gt;  3 classific… 2     seto…          1    0.692           0.123            0.984</span>
<span class="co">#&gt;  4 classific… 2     seto…          1    0.692           0.123            0.984</span>
<span class="co">#&gt;  5 classific… 3     seto…          1    0.686           0.129            0.983</span>
<span class="co">#&gt;  6 classific… 3     seto…          1    0.686           0.129            0.983</span>
<span class="co">#&gt;  7 classific… 4     seto…          1    0.695           0.119            0.985</span>
<span class="co">#&gt;  8 classific… 4     seto…          1    0.695           0.119            0.985</span>
<span class="co">#&gt;  9 classific… 5     seto…          1    0.694           0.123            0.984</span>
<span class="co">#&gt; 10 classific… 5     seto…          1    0.694           0.123            0.984</span>
<span class="co">#&gt; # … with 6 more variables: feature &lt;chr&gt;, feature_value &lt;dbl&gt;,</span>
<span class="co">#&gt; #   feature_weight &lt;dbl&gt;, feature_desc &lt;chr&gt;, data &lt;list&gt;, prediction &lt;list&gt;</span>

<span class="co"># And can be visualised directly</span>
<span class="fu"><a href="reference/plot_features.html">plot_features</a></span><span class="op">(</span><span class="va">explanation</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png"><!-- --></p>
<p><code>lime</code> also supports explaining image and text models. For image explanations the relevant areas in an image can be highlighted:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">explanation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/.load_image_example.html">.load_image_example</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="reference/plot_image_explanation.html">plot_image_explanation</a></span><span class="op">(</span><span class="va">explanation</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png"><!-- --></p>
<p>Here we see that the second most probably class is hardly true, but is due to the model picking up waxy areas of the produce and interpreting them as wax-light surface.</p>
<p>For text the explanation can be shown by highlighting the important words. It even includes a <code>shiny</code> application for interactively exploring text models:</p>
<p><img src="reference/figures/shine_text_explanations.gif" alt="interactive text explainer"></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><code>lime</code> is available on CRAN and can be installed using the standard approach:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'lime'</span><span class="op">)</span></code></pre></div>
<p>To get the development version, install from GitHub instead:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages('devtools')</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">'thomasp85/lime'</span><span class="op">)</span></code></pre></div>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the ‘lime’ project is released with a <a href="https://lime.data-imaginist.com/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=lime">https://​cloud.r-project.org/​package=lime</a>
</li>
<li>Browse source code at <br><a href="https://github.com/thomasp85/lime/">https://​github.com/​thomasp85/​lime/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/thomasp85/lime/issues">https://​github.com/​thomasp85/​lime/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://data-imaginist.com">Thomas Lin Pedersen</a> <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-5147-4711" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Michaël Benesty <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/thomasp85/lime/actions"><img src="https://github.com/thomasp85/lime/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/thomasp85/lime?branch=master"><img src="https://codecov.io/gh/thomasp85/lime/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://CRAN.R-project.org/package=lime"><img src="http://www.r-pkg.org/badges/version-ago/lime" alt="CRAN_Release_Badge"></a></li>
<li><a href="https://CRAN.R-project.org/package=lime"><img src="http://cranlogs.r-pkg.org/badges/lime" alt="CRAN_Download_Badge"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://data-imaginist.com">Thomas Lin Pedersen</a>, Michaël Benesty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
